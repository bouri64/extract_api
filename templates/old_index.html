<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PDF Regex Search</title>

    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 40px auto;
        }

        #drop-zone {
            border: 2px dashed #888;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            margin-bottom: 20px;
        }

        #drop-zone.dragover {
            background-color: #eee;
        }

        label {
            display: block;
            margin-top: 12px;
        }

        .radio-group {
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ccc;
        }

        input[type="text"],
        input[type="number"] {
            width: 100%;
            padding: 6px;
        }

        button {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>

<h2>PDF Regex Search</h2>

<form action="/search"
      method="post"
      enctype="multipart/form-data"
      target="_blank">

    <!-- Drag & Drop Zone -->
    <div id="drop-zone">
        Drag & Drop PDF Here<br>
        <small>(or click to select)</small>
    </div>

    <!-- Hidden File Input -->
    <input type="file"
           id="file-input"
           name="file"
           accept="application/pdf"
           hidden>
    <label>
        CIK (don't upload file):
        <input type="text" name="cik">
    </label>
    <label>
        Company (don't upload file nor precise CIK):
        <input type="text" name="company" list="company-list">
    </label>
    <datalist id="company-list">
    {% for company in companies %}
        <option value="{{ company }}">
    {% endfor %}
    </datalist>

    <label for="year">Year for CIK</label>
    <input
        type="number"
        id="year"
        name="year"
        min="1900"
        max="2100"
        step="1"
        placeholder="2025"
    >

    <label>
        Regex / Text:
        <input type="text" name="pattern" value="(?:Basic earnings|Basic net income|Earnings|Net income) per (?:common )?share">
    </label>

    <label>
        Prompt (optional):
        <input type="text" name="base">
    </label>
    
    <label for="model">Model:</label>

    <select name="model" id="model">
        <option value="">-- Select a model --</option>
        <option value="openai/gpt-oss-120b" selected>gpt-oss-120b</option>
        <option value="openai/gpt-oss-20b">gpt-oss-20b</option>
        <option value="meta-llama/llama-4-maverick-17b-128e-instruct">llama-4-maverick-17b-128e-instruct</option>
        <option value="meta-llama/llama-4-scout-17b-16e-instruct">llama-4-scout-17b-16e-instruct</option>
        <option value="groq/compound">groq/compound</option>
        <option value="qwen/qwen3-32b">qwen3-32b</option>
    </select>


    <label>
        Characters Before:
        <input type="number" name="before" value="2000">
    </label>

    <label>
        Characters After:
        <input type="number" name="after" value="800">
    </label>

    <!-- Result Type Selector -->
    <div class="radio-group">
        <strong>Result to open:</strong>

        <label>
            <input type="radio"
                   name="output_type"
                   value="text"
                   checked>
            First match text (context)
        </label>

        <label>
            <input type="radio"
                   name="output_type"
                   value="png">
            Highlighted PNG (Only supports pdf)
        </label>


        <label>
            <input type="radio"
                   name="output_type"
                   value="parse">
            Parse file
        </label>
    </div>

    <button type="submit">Search</button>
</form>

<script>
    const dropZone = document.getElementById("drop-zone");
    const fileInput = document.getElementById("file-input");

    // Click opens file picker
    dropZone.addEventListener("click", () => fileInput.click());

    // Drag over
    dropZone.addEventListener("dragover", (e) => {
        e.preventDefault();
        dropZone.classList.add("dragover");
    });

    // Drag leave
    dropZone.addEventListener("dragleave", () => {
        dropZone.classList.remove("dragover");
    });

    // Drop file
    dropZone.addEventListener("drop", (e) => {
        e.preventDefault();
        dropZone.classList.remove("dragover");

        if (e.dataTransfer.files.length > 0) {
            fileInput.files = e.dataTransfer.files;
            dropZone.innerHTML = e.dataTransfer.files[0].name;
        }
    });

    // Show selected file name
    fileInput.addEventListener("change", () => {
        if (fileInput.files.length > 0) {
            dropZone.innerHTML = fileInput.files[0].name;
        }
    });
</script>

</body>
</html>
